@import "~@future/core/src/style/base/variables";
@import "~@future/core/src/style/base/mixins";
@import "~@future/loading/dist/style.scss";

$upload-prefix-cls: '#{$namespace}-upload';
$upload-item: '#{$namespace}-upload-list-item';
$iconfont-css-prefix: '#{$namespace}-icon';
$upload-picture-card-size: 90px;
$primary-color: #007DFA;
$border-width-base: 1px;
$bg-color-base: #E6ECF2;
$border-color-base: #CED3D9;
$border-radius-base: $--border-radius-base;
$line-height-base: 1.5;
$font-size-base: $--font-size-base;
$upload-actions-color: $--color-grey;
$upload-actions-color-inverse: $--color-grey;
$upload-actions-color-dark: $--color-grey;
$upload-actions-color-secondary: $--color-grey;
$upload-actions-color-hover: $--color-grey;
$error-color: $--color-red;

.#{$upload-prefix-cls} {

    outline: 0;

    p {
        margin: 0;
    }

    &-btn {
        display: block;
        width: 100%;
        outline: none;
    }

    input[type='file'] {
        cursor: pointer;
    }

    &-select {
        display: inline-block;
    }

    &-disabled {
        cursor: not-allowed;
    }

    &-error{
        color: $error-color;
        margin-top: 10px;
    }

    &-select-picture-card {
        width: $upload-picture-card-size;
        height: $upload-picture-card-size;
        margin-right: 8px;
        margin-bottom: 8px;
        text-align: center;
        vertical-align: top;
        background-color: #F5F7FA;
        border: $border-width-base dashed $border-color-base;
        border-radius: $border-radius-base;
        cursor: pointer;
        transition: border-color 0.3s;
        box-sizing: border-box;
        >.#{$upload-prefix-cls} {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
        }

        &:hover {
            border-color: $primary-color;

            &-disabled {
                border-color: $border-color-base;
            }
        }

        .ft-icon.icon-add{
            font-size: 32px;
            color: #b3b3b3;
        }
    }

    &-picture-card-wrapper {
        @include clearfix();

        display: inline-block;
        width: 100%;
    }
}

.#{$upload-prefix-cls}-list {
    @include clearfix();
    line-height: $line-height-base;

    // ============================ Item ============================
    &-item {
        position: relative;
        margin-top: 10px;
        font-size: $font-size-base;

        &-name {
            display: inline-block;
            width: 100%;
            padding-left: 5px;
            overflow: hidden;
            line-height: $line-height-base;
            white-space: nowrap;
            text-overflow: ellipsis;
        }

        &-card-actions {
            position: absolute;
            right: 0;

            &-btn.#{$iconfont-css-prefix}-sm {
                height: $line-height-base * $font-size-base;
                line-height: 1;
                vertical-align: top;
            }

            &.picture {
                top: 22px;
                line-height: 0;
            }

            &-btn:focus,
            &.picture &-btn {
                opacity: 1;
            }

            .#{$iconfont-css-prefix} {
                color: $upload-actions-color;
                transition: all 0.3s;
            }

            &:hover .#{$iconfont-css-prefix} {
                color: $upload-actions-color-hover;
            }

            &-btn{
                cursor: pointer;
                .#{$iconfont-css-prefix}{
                    font-size: 18px;
                }
                &:hover .#{$iconfont-css-prefix}{
                    color: $error-color;
                }
            }
        }

        &-info {
            transition: background-color 0.3s;

            >span {
                display: block;
                width: 100%;
                height: 100%;
            }
        }

        &-error,
        &-error .#{$upload-prefix-cls}-text-icon>.#{$iconfont-css-prefix},
        &-error &-name {
            color: $error-color;
        }

        &-error &-card-actions {
            .#{$iconfont-css-prefix} {
                color: $error-color;
            }
        }
    }

    // =================== Picture & Picture Card ===================
    &-picture,
    &-picture-card {
        .#{$upload-item} {
            position: relative;
            height: 66px;
            border-radius: $border-radius-base;
            overflow: hidden;
            box-sizing: border-box;

            &-error {
                border-color: $error-color;
            }
        }

        .#{$upload-item}-info {
            padding: 0;
        }

        .#{$upload-item}:hover .#{$upload-item}-info {
            background: transparent;
        }

        .#{$upload-item}-thumbnail {
            width: 48px;
            height: 48px;
            text-align: center;
            opacity: 0.8;

            .#{$iconfont-css-prefix} {
                font-size: 26px;
            }
        }

        // Adjust the color of the error icon : https://github.com/ant-design/ant-design/pull/24160
        .#{$upload-item}-error .#{$upload-item}-thumbnail {
            .#{$iconfont-css-prefix} {
                svg path {
                    &[fill='#e6f7ff'] {
                        fill: $error-color;
                    }

                    &[fill='#1890ff'] {
                        fill: $error-color;
                    }
                }
            }
        }

        .#{$upload-item}-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            font-size: 26px;
            transform: translate(-50%, -50%);

            .#{$iconfont-css-prefix} {
                font-size: 26px;
            }

            .ft-icon{
                color: #555;
            }
        }

        .#{$upload-item}-image {
            max-width: 100%;
        }

        .#{$upload-item}-thumbnail img {
            display: block;
            width: 48px;
            height: 48px;
            overflow: hidden;
        }

        .#{$upload-item}-progress {
            bottom: 14px;
            width: calc(100% - 24px);
            margin-top: 0;
            padding-left: 56px;
        }
    }

    &-picture{
        
    }

    // ======================== Picture Card ========================
    &-picture-card {
        &-container {
            display: inline-block;
            width: $upload-picture-card-size;
            height: $upload-picture-card-size;
            margin: 0 8px 8px 0;
            vertical-align: top;
        }

        .#{$upload-item} {
            height: 100%;
            margin: 0;
            background-color: #F5F7FA;
            padding: 1px;
            &-uploading{
                padding: 0;
                border: 1px dashed $border-color-base;
            }
        }

        .#{$upload-item}-info {
            position: relative;
            height: 100%;
            overflow: hidden;

            &::before {
                position: absolute;
                z-index: 1;
                width: 100%;
                height: 100%;
                background-color: transparent;
                opacity: 0;
                transition: all 0.3s;
                content: ' ';
            }
        }

        .#{$upload-item}:hover .#{$upload-item}-info::before {
            opacity: 1;
        }

        .#{$upload-item}-actions {
            position: absolute;
            right: 0;
            left: 0;
            bottom: 0;
            height: 30px;
            z-index: 10;
            white-space: nowrap;
            opacity: 0;
            transition: all 0.3s;
            background-color: transparentize($--color-black, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;

            .#{$upload-item}-card-actions-btn, &-link{
                flex: 1;
                text-align: center;
            }

            .#{$iconfont-css-prefix}.icon-eye,
            .#{$iconfont-css-prefix}.icon-recycle,
            .#{$iconfont-css-prefix}.icon-delete {
                z-index: 10;
                color: #fff;
                font-size: 16px;
                cursor: pointer;
                transition: all 0.3s;

                &:hover {
                    color: #fff;
                }
            }
        }

        .#{$upload-item}-info:hover+.#{$upload-item}-actions,
        .#{$upload-item}-actions:hover {
            opacity: 1;
        }

        .#{$upload-item}-thumbnail,
        .#{$upload-item}-thumbnail img {
            position: static;
            display: block;
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .#{$upload-item}-name {
            display: none;
            padding: 0;
            line-height: $line-height-base;
            text-align: center;
        }

        .#{$upload-item}-file{
            padding-top: 10px;
            &+.#{$upload-item}-name {
                position: absolute;
                bottom: 15px;
                display: block;
                padding: 0 10px;
                width: 100%;
                text-align: center;
                box-sizing: border-box;
                color: #888;
            }

            .ft-icon{
                color: #555;
            }
        }

        .#{$upload-item}-uploading {

            .#{$upload-item}-info {

                &::before,
                .#{$iconfont-css-prefix}-eye,
                .#{$iconfont-css-prefix}-delete {
                    display: none;
                }
            }

            .ft-loading-txt{
                font-size: 14px;
                color: #888;
            }
        }
        .#{$upload-item}-thumbnail-loading{
            display: flex;
            flex-direction:column;
            justify-content: center;
            align-items: center;
        }

        .#{$upload-item}-progress {
            position: absolute;
            top: 50%;
            left: 10px;
            width: calc(100% - 20px);
            height: 4px;
            margin-top: 0;
            background-color: #CED3D9;
            border-radius: 3px;
            &-percent{
                display: none;
            }

            &-bar{
                position: absolute;
                left: 0;
                height: 100%;
                border-radius: 3px;
                transition: width 0.3s cubic-bezier(.08,.82,.17,1) 0s;
                background-color: $primary-color;
            }
        }
    }

    // ======================= Picture & Text =======================
    &-text,
    &-picture {
        &-container {
            transition: opacity 0.3s, height 0.3s;

            &::before {
                display: table;
                width: 0;
                height: 0;
                content: '';
            }

            // Don't know why span here, just stretch it
            .#{$upload-prefix-cls}-span {
                display: block;
                flex: auto;
            }
        }

        // text & picture no need this additional element.
        // But it used for picture-card, let's keep it.
        .#{$upload-prefix-cls}-span {
            display: flex;
            align-items: center;

            >* {
                flex: none;
            }
        }

        .#{$upload-item}-name {
            flex: auto;
            margin: 0;
            color: #888;

            &.is-loading{
                color: $primary-color;
            }
        }

        a.#{$upload-item}-name {
            &:hover{
                color: $primary-color;
            }
        }

        .#{$upload-item}-card-actions {
            position: static;
        }

        .#{$upload-item}-progress {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            height: 100%;
            line-height: 0;
            // background-color: transparentize($--color-black, 0.7);
            background-color: transparent;
            border-radius: $border-radius-base;
            border: 1px solid $primary-color;
            box-sizing: border-box;
            &-bar {
                display: flex;
                align-items: center;
                position: absolute;
                justify-content: flex-end;
                top: 0;
                bottom: 0;
                left: 0;
                width: 0;
                background-color: transparentize($primary-color, 0.4);
                transition: width 0.3s cubic-bezier(.08,.82,.17,1) 0s;
            }

            &-percent {
                // position: relative;
                // z-index: 2;
                display: none;
            }
        }
    }

    &-picture{
        .#{$upload-item} {
            padding: 8px;
            border: $border-width-base solid $primary-color;
            background-color: $bg-color-base;
            overflow: hidden;
        }

        .#{$upload-item}-done{
            border-color: $bg-color-base;
        }

        .#{$upload-item}-info {
            height: 100%;
        }

        .#{$upload-item}-thumbnail {
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .#{$upload-item}-name {
            display: inline-block;
            box-sizing: border-box;
            max-width: 100%;
            margin: 0 0 0 8px;
            padding-right: 8px;
            padding-left: 8px;
            overflow: hidden;
            line-height: 44px;
            white-space: nowrap;
            text-overflow: ellipsis;
            transition: all 0.3s;
        }
    }

    // ============================ Text ============================
    &-text {

        .#{$upload-item} {
            padding: 0px 10px;
            border-radius: $border-radius-base;
            background-color: $bg-color-base;
            height: 31px;
            box-sizing: border-box;
            overflow: hidden;
            &-info{
                height: 100%;
            }
        }

        .#{$upload-item}-uploading{
            .#{$upload-item}-name{
                color: $primary-color;
            }
        }

        .#{$upload-item}-done{
            background-color: $bg-color-base;
        }

        .#{$upload-prefix-cls}-text-icon{
            
            &.is-loading{
                width: 16px;
                height: 16px;
            }

            &>.#{$iconfont-css-prefix} {
                color: #222;
            }

            .ft-loading.is-s{
                width: 100%;
                height: 100%;
            }

            .ft-icon{
                font-size: 16px;
                color: #555;
            }
            
        }
    }

    // =========================== Motion ===========================
    .#{$upload-prefix-cls}-animate-inline-appear,
    .#{$upload-prefix-cls}-animate-inline-enter,
    .#{$upload-prefix-cls}-animate-inline-leave {
        animation-duration: 0.3s;
        animation-fill-mode: cubic-bezier(0.78, 0.14, 0.15, 0.86);
        ;
    }

    .#{$upload-prefix-cls}-animate-inline-appear,
    .#{$upload-prefix-cls}-animate-inline-enter {
        animation-name: uploadAnimateInlineIn;
    }

    .#{$upload-prefix-cls}-animate-inline-leave {
        animation-name: uploadAnimateInlineOut;
    }

    .#{$upload-prefix-cls}-fade-enter,
    .#{$upload-prefix-cls}-fade-appear,
    .#{$upload-prefix-cls}-fade-leave {
        animation-duration: 0.3s;
        animation-fill-mode: both;
        animation-play-state: paused;
    }

    .#{$upload-prefix-cls}-fade-enter.#{$upload-prefix-cls}-fade-enter-active,
    .#{$upload-prefix-cls}-fade-appear.#{$upload-prefix-cls}-fade-appear-active {
        animation-name: ftFadeIn;
        animation-play-state: running;
    }

    .#{$upload-prefix-cls}-fade-enter,
    .#{$upload-prefix-cls}-fade-appear {
        opacity: 0;
        animation-timing-function: linear;
    }


}

@keyframes uploadAnimateInlineIn {
    from {
        width: 0;
        height: 0;
        margin: 0;
        padding: 0;
        opacity: 0;
    }
}

@keyframes uploadAnimateInlineOut {
    to {
        width: 0;
        height: 0;
        margin: 0;
        padding: 0;
        opacity: 0;
    }
}

@keyframes ftFadeIn {
    0% {
        opacity: 0
    }

    to {
        opacity: 1
    }
}

@keyframes ftFadeOut {
    0% {
        opacity: 1
    }

    to {
        opacity: 0
    }
}